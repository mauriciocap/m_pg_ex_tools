<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="format-detection" content="telephone=no" />
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />
        <title>Your fastapp name here</title>
    </head>
    <body>
        <div class="app">
            <h1>FastApp Tools Ex</h1>
        </div>
        <script type="text/javascript" src="phonegap.js"></script>
        <script type="text/javascript" src="js/3p/zepto.min.js"></script>
        <script type="text/javascript">

	function onFail(d) {
		alert("ERROR "+d);
	}

	function getFile(path, cb) {
		var readAsText= function (file) {
        var reader = new FileReader();
        reader.onloadend = function(evt) {
            alert("READ TXT "+evt.target.result);
						cb(evt.target.result);	
        };
        reader.readAsText(file);
    };

		var onGotFile= function (file) { readAsText(file); }

		var onGotFileEntry= function (fileEntry) { fileEntry.file(onGotFile,onFail); }

		var onGotFs: function (fileSystem) {
			fileSystem.root.getFile(path, {create: false}, onGotFileEntry, onFail);
		}
		alert("GETTING FILE '"+url+"'");
		window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, onGotFs, onFail);
	} 
    
	function getHttp(url,cb) {
		alert("GETTING '"+url+"'");
		$.ajax({
			url: url,
			success: function(data){
					alert("GOT "+data);
					cb(data);
			},
			error: onFail
		});
	}

	function jsSet(txt) { $('#inJs').val(txt); }
	function pathGet() { return $('#inUrl').val(); }

 	var Initialized= false;
 	function appReady() {
		if (Initialized) { return true; }
		Initialized= true;

		$('#btnGet').on('click', function () { try { getHttp(urlGet(),jsSet);} catch(e) { alert("ERR:"+e) }; return false; });
		$('#btnFile').on('click', function () { try { getFile(urlGet(),jsSet); } catch(e) { alert("ERR:"+e) }; return false; });

		$('#btnEval').on('click', function () { try { var js= $('#inJs').val(); alert("EVAL '"+js+"'"); eval(js); } catch(e) { alert("ERR:"+e) }; return false; });

		$('#btnEx').on('click', function () {
			$('inUrl').val("https://raw.githubusercontent.com/mauriciocap/m_pg_ex_tools/master/examples.js");
			return false;
		});
	 }

	 document.addEventListener("deviceready", appReady, false);
	 document.addEventListener("DOMContentLoaded", appReady, false);
</script>
</head>
<body>
<div id="load">
		 <input id="inUrl" size=80></br>
		 <input id="btnGet" type="button" value="Get">
  	 <input id="btnFile" type="button" value="File"> 
		 <input id="btnEval" type="button" value="Eval"></br>
		 <input id="btnEx" type="button" value="ExUrl"></br>
     <textarea id="inJs" cols=80 rows=25>
     </textarea>
</div>
</body>
</html>
